# Logging Configuration

logging:
  version: 1
  disable_existing_loggers: false
  
  formatters:
    standard:
      format: '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
    
    json:
      format: '%(message)s'
      class: pythonjsonlogger.jsonlogger.JsonFormatter
    
    detailed:
      format: '%(asctime)s - %(name)s - %(levelname)s - [%(filename)s:%(lineno)d] - %(message)s'
  
  handlers:
    console:
      class: logging.StreamHandler
      level: INFO
      formatter: standard
      stream: ext://sys.stdout
    
    file:
      class: logging.handlers.RotatingFileHandler
      level: DEBUG
      formatter: detailed
      filename: /var/log/sdn-nidps/app.log
      maxBytes: 10485760  # 10MB
      backupCount: 10
    
    threat_file:
      class: logging.handlers.RotatingFileHandler
      level: WARNING
      formatter: json
      filename: /var/log/sdn-nidps/threats.json
      maxBytes: 52428800  # 50MB
      backupCount: 20
    
    syslog:
      class: logging.handlers.SysLogHandler
      level: INFO
      formatter: standard
      address: /dev/log
      facility: local5
  
  loggers:
    src.sdn_controller:
      level: INFO
      handlers: [console, file]
    
    src.threat_detector:
      level: DEBUG
      handlers: [file, threat_file]
    
    ids_integration.alert_processor:
      level: INFO
      handlers: [file, syslog]
  
  root:
    level: INFO
    handlers: [console, file]
